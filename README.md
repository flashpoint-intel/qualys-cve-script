# Qualys-cve-script

## Python Requirements

Python 3.7 is required to run this script, to setup this environment to run you would create a virtual environment for the application:

    virtualenv -p python3 venv
    source venv/bin/activate

The required Python libraries can be found in the requirements.txt. They can be installed using:

	pip install -r requirements.txt

Please be aware any time you need to run this script you would need to run `source venv/bin/activate` from the directory you set that up in.

## Qualys Configuration File

The script can use a configuration file or options set while running the script. 
The following is the configuration setup, you can use the provided template or create your own.

	[qualys_login]
	username = <Qualys_username> # Provide your Qualys User Name you use to login
	password = <Qualys_password> # Provide your Qualys Password to login, make sure this file is locked down to your user
	
	[qualys_api_url]
	url = <Qualys_api_url> # This can be found in your Qualys Dashboard Help -> About -> Security Operations Center: look for the api url, omit the :443 at the end
	
	[qualys_scans]
	scan_ref = <Qualys_scan_ref> # This can be found under Scans -> Scans tab -> Look for the Reference Column, needs the entire string scan/<number>

## Qualys Script Switches

Running qualys_api.py can handle some switches, below is the help text from qualys_api.py -h:

	usage: qualys_api.py [-h] [-user USER] [-api API] [-scan SCAN]
	                     [-config CONFIG]
	
	Pull CVEs from Qualys Scanner for use with the Flashpoint Platform. A
	username, API endpoint, and Scan Reference must be provided or a configuration
	file using the -config tag. A default configuration file can be stored in the
	same directory as this script with the name of qualys_fp.conf which should be
	provided with this script.
	
	optional arguments:
	  -h, --help      show this help message and exit
	  -user USER      User Name for Qualys
	  -api API        Qualys API Endpoint
	  -scan SCAN      Scan Reference (scan/<ref>)
	  -config CONFIG  Path to a Configuration File

If you're running with the switches you are required to use `-user` <user_name> `-api` <api_url> `-scan` <scan_reference>